# POPPON í”„ë¡œì íŠ¸ STATUS

## í”„ë¡œì íŠ¸ ê°œìš”
- **ì œí’ˆëª…**: POPPON (K-RetailMeNot)
- **ê¸°íšì„œ ë²„ì „**: v1.2.1
- **í•œì¤„ ì •ì˜**: í•œêµ­ì˜ ëª¨ë“  í• ì¸/ì¿ í°/í”„ë¡œëª¨ì…˜ì„ í•œ ê³³ì— ëª¨ì•„, ê²€ìƒ‰Â·í•„í„°Â·ì¹´í…Œê³ ë¦¬Â·ìº˜ë¦°ë”Â·íë ˆì´ì…˜ìœ¼ë¡œ íƒìƒ‰ â†’ ì €ì¥/êµ¬ë…/ì•Œë¦¼ìœ¼ë¡œ DB ì¶•ì  â†’ TargetUP-AI CRM-Outside ê³ ë‹¨ê°€ íƒ€ê²Ÿë§ˆì¼€íŒ…ìœ¼ë¡œ ìˆ˜ìµí™”í•˜ëŠ” ë”œ í”Œë«í¼
- **MVP ìš°ì„ ìˆœìœ„**: A(ì˜¨ë¼ì¸ ì¿ í°/í”„ë¡œëª¨ì…˜ ì½”ë“œ) â†’ B(ì•±ì¿ í°/ë§í¬í˜•) â†’ C(ì˜¤í”„ë¼ì¸ ì´ë²¤íŠ¸)
- **í•µì‹¬ ë°©í–¥**: í• ì¸ì •ë³´ë¥¼ ë³´ê¸° ì‰½ê²Œ ëª¨ì•„ì„œ DB ì¶•ì  â†’ ìˆ˜ìµí™” (RetailMeNot ì½”ë“œë³µì‚¬/ìºì‹œë°± ëª¨ë¸ê³¼ ë‹¤ë¦„)
- **í”„ë¡œì íŠ¸ ê²½ë¡œ**: `C:\projects\poppon`
- **ë„ë©”ì¸**: `poppon.kr` (ê°€ë¹„ì•„, DNS ì„¤ì • í•„ìš”)
- **ë°°í¬ URL**: `https://poppon.vercel.app` âœ… ë¼ì´ë¸Œ
- **GitHub**: `https://github.com/hoyun5295-ctrl/poppon` (private)

---

## âš ï¸ ê°œë°œ ì›ì¹™
> **ì ˆëŒ€ ì›ì¹™**: ì‹œí‚¤ê¸° ì „ì— ì½”ë“œ/íŒŒì¼ ë§Œë“¤ì§€ ì•ŠëŠ”ë‹¤.
> ë°˜ë“œì‹œ **ê¸°ì¡´ íŒŒì¼ íŒŒì•… â†’ ì„¤ê³„ ì˜ë…¼ â†’ í•©ì˜ í›„ êµ¬í˜„** ìˆœì„œ.
> ê¸°ì¡´ ì½”ë“œ ë§ê°€ëœ¨ë¦¬ì§€ ì•Šë„ë¡ í˜„ì¬ êµ¬ì¡°ë¶€í„° í™•ì¸í•œë‹¤.

---

## í•µì‹¬ ì‚¬ìš©ì íë¦„ (Top 5)
1. í™ˆ â†’ ê²€ìƒ‰/ì¹´í…Œê³ ë¦¬ íƒìƒ‰ â†’ ë”œ ìƒì„¸(ëª¨ë‹¬) â†’ ì½”ë“œë³µì‚¬/ì‚¬ì´íŠ¸ì´ë™
2. ë”œ ìƒì„¸ â†’ "ì €ì¥/ì•Œë¦¼" â†’ íœ´ëŒ€í° ê°€ì…/ë™ì˜ â†’ ì €ì¥ ì™„ë£Œ
3. ì¹´í…Œê³ ë¦¬ í—ˆë¸Œ â†’ ë§ˆê°ì„ë°•/ì´ë²ˆì£¼ íƒìƒ‰ â†’ íŠ¸ë Œë”© ë”œ ì†Œë¹„
4. ë¸Œëœë“œê´€ â†’ êµ¬ë… â†’ ì‹ ê·œ ë”œ ì•Œë¦¼ ìˆ˜ì‹ 
5. ìœ ì € ì œë³´(ë§í¬ ì œì¶œ) â†’ ìë™ íŒŒì‹± â†’ ìš´ì˜ì ìŠ¹ì¸ â†’ ì¸ë²¤í† ë¦¬ í™•ì¥

---

## ìˆ˜ê¸‰ íŠ¸ë™ (D' = A + B + C + F)
| íŠ¸ë™ | ì„¤ëª… | Phase |
|------|------|-------|
| A) í¬ë¡¤ë§ | ì»¤ë„¥í„° ê¸°ë°˜ ìë™ ìˆ˜ê¸‰ | Phase 1 |
| B) ë¸Œëœë“œ í¬í„¸ | ë¸Œëœë“œ ì…€í”„ ì—…ë¡œë“œ | Phase 2 |
| C) ìœ ì € ì œë³´ | ë§í¬ ì œì¶œ â†’ íŒŒì‹± â†’ ìŠ¹ì¸ | Phase 1 |
| F) ì œíœ´ ë„¤íŠ¸ì›Œí¬ API | ë§í¬í”„ë¼ì´ìŠ¤ ë“± í•«ë”œ/ë”¥ë§í¬ | Phase 0 ë³‘í–‰ |

---

## ğŸš¨ ë‹¤ìŒ ì±„íŒ… ì‹œì‘ ì‹œ ì¦‰ì‹œ í™•ì¸ì‚¬í•­

### 1. í¬ë¡¤ëŸ¬ v3 íŒŒì¼ ì ìš© í™•ì¸
3ê°œ íŒŒì¼ ë®ì–´ì“°ê¸° í™•ì¸:
- `src/lib/crawl/ai-engine.ts` â€” v3 (ë³‘ë ¬+**DB í•´ì‹œ ë³€ê²½ê°ì§€**+ì†ë„ìµœì í™”)
- `src/app/api/admin/ai-crawl/route.ts` â€” v3 (content_hash DB ì½ê¸°/ì €ì¥)
- `src/lib/crawl/save-deals.ts` â€” v2 (title ê¸°ë°˜ ì¤‘ë³µì²´í¬+ë°°ì¹˜ë‚´ ì¤‘ë³µë°©ì§€)

**í™•ì¸ ë°©ë²•**: ai-engine.ts ìƒë‹¨ì— "v3" / save-deals.ts ìƒë‹¨ì— "v2"

### 2. DB ì»¬ëŸ¼ ì¶”ê°€ í™•ì¸
```sql
SELECT content_hash, hash_updated_at FROM crawl_connectors LIMIT 1;
```
ì—ëŸ¬ë‚˜ë©´ ì‹¤í–‰:
```sql
ALTER TABLE crawl_connectors 
ADD COLUMN content_hash VARCHAR(32),
ADD COLUMN hash_updated_at TIMESTAMPTZ;
```

### 3. ì¬í¬ë¡¤ë§ ê²°ê³¼ í™•ì¸
```sql
SELECT COUNT(*) FROM deals WHERE status = 'active';
SELECT status, COUNT(*) FROM crawl_runs WHERE started_at > NOW() - INTERVAL '24 hours' GROUP BY status;
```

### 4. ì¤‘ë³µ ë”œ ì”ì¡´ í™•ì¸
```sql
SELECT merchant_id, title, COUNT(*) as cnt FROM deals WHERE status = 'active' GROUP BY merchant_id, title HAVING COUNT(*) > 1 ORDER BY cnt DESC LIMIT 10;
```
ìˆìœ¼ë©´ ì •ë¦¬:
```sql
WITH ranked AS (
  SELECT id, ROW_NUMBER() OVER (PARTITION BY merchant_id, title ORDER BY created_at ASC) as rn
  FROM deals WHERE status = 'active'
)
UPDATE deals SET status = 'hidden' WHERE id IN (SELECT id FROM ranked WHERE rn > 1);
```

### 5. ì»¤ë„¥í„° í˜„í™© í™•ì¸
```sql
SELECT status, COUNT(*) FROM crawl_connectors GROUP BY status;
-- ê¸°ëŒ€ê°’: active ~228, disabled ~96, error ~25
```

### 6. deal_actions í…Œì´ë¸” í™•ì¸
```sql
SELECT COUNT(*) FROM deal_actions;
```
ì—ëŸ¬ë‚˜ë©´ ì•„ë˜ "íšŒì›ê°€ì… & í–‰ë™ì¶”ì " ì„¹ì…˜ì˜ SQL ì‹¤í–‰

---

## ğŸ“ ì°¸ì¡° íŒŒì¼ ëª©ë¡

### ì»´í¬ë„ŒíŠ¸ / UI
| íŒŒì¼ | ê²½ë¡œ |
|------|------|
| DealCard.tsx | `src/components/deal/DealCard.tsx` |
| DealShelf.tsx | `src/components/deal/DealShelf.tsx` |
| DealGrid.tsx | `src/components/deal/DealGrid.tsx` |
| DealDetail.tsx | `src/components/deal/DealDetail.tsx` |
| DealModal.tsx | `src/components/deal/DealModal.tsx` |
| CopyCodeButton.tsx | `src/components/deal/CopyCodeButton.tsx` |
| TopNav.tsx | `src/components/layout/TopNav.tsx` |
| Footer.tsx | `src/components/layout/Footer.tsx` |
| SourceProtection.tsx | `src/components/layout/SourceProtection.tsx` |
| MobileFilterSheet.tsx | `src/components/search/MobileFilterSheet.tsx` |
| SearchBar.tsx | `src/components/search/SearchBar.tsx` |
| SearchFilters.tsx | `src/components/search/SearchFilters.tsx` |
| SearchInput.tsx | `src/components/search/SearchInput.tsx` |
| CategoryGrid.tsx | `src/components/category/CategoryGrid.tsx` |
| SubCategoryChips.tsx | `src/components/category/SubCategoryChips.tsx` |
| CategoryTabBar.tsx | `src/components/category/CategoryTabBar.tsx` |
| CategoryIcon.tsx | `src/components/category/CategoryIcon.tsx` |
| MerchantDealTabs.tsx | `src/components/merchant/MerchantDealTabs.tsx` |
| Pagination.tsx | `src/components/common/Pagination.tsx` |
| SortDropdown.tsx | `src/components/common/SortDropdown.tsx` |

### í˜ì´ì§€
| íŒŒì¼ | ê²½ë¡œ |
|------|------|
| ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ | `src/app/layout.tsx` |
| ê¸€ë¡œë²Œ CSS | `src/app/globals.css` |
| ë¯¸ë“¤ì›¨ì–´ | `src/middleware.ts` |
| í™ˆ | `src/app/page.tsx` |
| ê²€ìƒ‰ | `src/app/search/page.tsx` |
| ì¹´í…Œê³ ë¦¬ | `src/app/c/[categorySlug]/page.tsx` |
| ë¸Œëœë“œê´€ | `src/app/m/[merchantSlug]/page.tsx` |
| ë”œ ìƒì„¸ (ëª¨ë‹¬) | `src/app/@modal/(.)d/[slug]/page.tsx` |
| ë”œ ìƒì„¸ (í’€í˜ì´ì§€) | `src/app/d/[slug]/page.tsx` |
| ì œë³´ | `src/app/submit/page.tsx` |
| ë§ˆì´í˜ì´ì§€ | `src/app/me/page.tsx` |
| ë¡œê·¸ì¸ | `src/app/auth/page.tsx` |
| ì–´ë“œë¯¼ ë¡œê·¸ì¸ | `src/app/admin/login/page.tsx` |

### ë°ì´í„° / íƒ€ì… / ìœ í‹¸
| íŒŒì¼ | ê²½ë¡œ |
|------|------|
| database.ts (íƒ€ì…) | `src/types/database.ts` |
| index.ts (re-export) | `src/types/index.ts` |
| deals.ts (ë°ì´í„°) | `src/lib/deals.ts` |
| tracking.ts (í–‰ë™ì¶”ì ) | `src/lib/tracking.ts` |
| format.ts (ìœ í‹¸) | `src/lib/utils/format.ts` |
| constants.ts | `src/lib/constants.ts` |
| Supabase ì„œë²„ | `src/lib/supabase/server.ts` |
| Supabase ë¸Œë¼ìš°ì € | `src/lib/supabase/client.ts` |

### í¬ë¡¤ëŸ¬ / API
| íŒŒì¼ | ê²½ë¡œ |
|------|------|
| AI í¬ë¡¤ ì—”ì§„ (v3) | `src/lib/crawl/ai-engine.ts` |
| ë”œ ì €ì¥ (v2) | `src/lib/crawl/save-deals.ts` |
| Cron ë°°ì¹˜ | `src/app/api/cron/crawl/route.ts` |
| AI í¬ë¡¤ API (v3) | `src/app/api/admin/ai-crawl/route.ts` |
| AI í¬ë¡¤ API (ë‹¨ì¼) | `src/app/api/admin/ai-crawl/[connectorId]/route.ts` |
| ì œë³´ API | `src/app/api/submit/route.ts` |
| í–‰ë™ì¶”ì  API | `src/app/api/actions/route.ts` |
| í´ë¦­ íŠ¸ë˜í‚¹ | `src/app/out/[dealId]/route.ts` |
| ì–´ë“œë¯¼ ì¸ì¦ | `src/app/api/admin/auth/route.ts` |

### ìŠ¤í¬ë¦½íŠ¸ (í¬ë¡¤ëŸ¬/ë¡œê³ )
| íŒŒì¼ | ê²½ë¡œ | ì„¤ëª… |
|------|------|------|
| í¬ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸ | `scripts/test-ai-crawl.ts` | ë³€ê²½ ê°ì§€ í¬í•¨ v2 |
| ì´ë²¤íŠ¸ í˜ì´ì§€ íƒì§€ | `scripts/detect-event-pages.ts` | í™ˆí˜ì´ì§€â†’ì´ë²¤íŠ¸URL ìë™ ì°¾ê¸° |
| ë¨¸ì²œíŠ¸ ë¡œê³  v2 | `scripts/fetch-merchant-logos.ts` | HTTP apple-touch-icon ìˆ˜ì§‘ |
| ë¨¸ì²œíŠ¸ ë¡œê³  v3.1 | `scripts/fetch-merchant-logos-v3.ts` | Puppeteer ì‚¬ì´íŠ¸ ì ‘ì† ìˆ˜ì§‘ |
| êµ¬ê¸€ ì´ë¯¸ì§€ ë¡œê³  | `scripts/fetch-logos-google.ts` | `"[ë¸Œëœë“œëª…] CI"` ê²€ìƒ‰ í¬ë¡¤ë§ |
| OG ì´ë¯¸ì§€ ìˆ˜ì§‘ | `scripts/fetch-og-images.ts` | landing_urlì—ì„œ og:image ì¶”ì¶œ |

### ë°ì´í„° íŒŒì¼
| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `poppon_brands_filtered.csv` | ë¸Œëœë“œ 494ê°œ (ì›ë³¸) |
| `crawl-targets-final.csv` | ìµœì¢… í¬ë¡¤ë§ ëŒ€ìƒ 187ê°œ |
| `debug-ai-crawl/event-pages-detected.csv` | ì´ë²¤íŠ¸ í˜ì´ì§€ íƒì§€ ê²°ê³¼ 494ê°œ |
| `debug-ai-crawl/crawl-targets.csv` | ì´ë²¤íŠ¸ URL í™•ë³´ 223ê°œ |

---

## ê¸°ìˆ  ìŠ¤íƒ
| ì˜ì—­ | ê¸°ìˆ  | ë¹„ê³  |
|------|------|------|
| Frontend + Backend | **Next.js 15 (App Router)** | SSR/SSG, API Routes |
| Database + Auth | **Supabase (PostgreSQL)** | RLS, Phone OTP |
| ìŠ¤íƒ€ì¼ë§ | **Tailwind CSS + shadcn/ui** | Pretendard |
| ìƒíƒœê´€ë¦¬ | **Zustand** | ê²½ëŸ‰ |
| ë°°í¬ | **Vercel** | Git push ìë™ ë°°í¬, Cron |
| ê²€ìƒ‰ | **PostgreSQL í’€í…ìŠ¤íŠ¸ (pg_trgm)** | ì´ˆê¸° 1ë§Œê±´ ìˆ˜ì¤€ ì¶©ë¶„, ì¶”í›„ Elasticsearch |
| AI í¬ë¡¤ëŸ¬ | **Puppeteer + Claude Haiku** | 228ê°œ ì»¤ë„¥í„° |
| ë³¸ì¸ì¸ì¦ | **PASS** | ì´ê´€ ì˜ˆì • |
| ì•Œë¦¼ | **ì¹´ì¹´ì˜¤ ì•Œë¦¼í†¡** | ì±„ë„ ê°œì„¤ í•„ìš” |

---

## í”„ë¡ íŠ¸ì—”ë“œ ë¼ìš°íŒ… êµ¬ì¡°

### ë”œ ìƒì„¸ (í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë‹¬)
```
src/app/
â”œâ”€â”€ layout.tsx               â€” modal parallel route slot í¬í•¨
â”œâ”€â”€ @modal/
â”‚   â”œâ”€â”€ default.tsx          â€” ëª¨ë‹¬ ì—†ì„ ë•Œ null
â”‚   â””â”€â”€ (.)d/[slug]/
â”‚       â””â”€â”€ page.tsx         â€” ì¸í„°ì…‰íŒ… ëª¨ë‹¬ (ë¦¬ìŠ¤íŠ¸ì—ì„œ í´ë¦­ ì‹œ)
â”œâ”€â”€ d/[slug]/
â”‚   â””â”€â”€ page.tsx             â€” SEO í’€ í˜ì´ì§€ (ì§ì ‘ì ‘ì†/êµ¬ê¸€ë´‡)
â”œâ”€â”€ m/[merchantSlug]/
â”‚   â””â”€â”€ page.tsx             â€” ë¸Œëœë“œê´€
â”œâ”€â”€ c/[categorySlug]/
â”‚   â””â”€â”€ page.tsx             â€” ì¹´í…Œê³ ë¦¬ í—ˆë¸Œ
â”œâ”€â”€ search/
â”‚   â””â”€â”€ page.tsx             â€” ê²€ìƒ‰ ê²°ê³¼
â”œâ”€â”€ submit/
â”‚   â””â”€â”€ page.tsx             â€” ìœ ì € ì œë³´
â”œâ”€â”€ me/
â”‚   â””â”€â”€ page.tsx             â€” ë§ˆì´í˜ì´ì§€
â”œâ”€â”€ auth/
â”‚   â””â”€â”€ page.tsx             â€” ë¡œê·¸ì¸/ê°€ì…
```
- í™ˆì—ì„œ í´ë¦­ â†’ ëª¨ë‹¬ (URL ë³€ê²½, ë’¤ë¡œê°€ê¸°=ë‹«í˜)
- `/d/:slug` ì§ì ‘ì ‘ì† â†’ í’€ í˜ì´ì§€ ë Œë”ë§ (SSR, SEO)
- í•œê¸€ slug â†’ decodeURIComponent ì²˜ë¦¬ í•„ìš” (deals.ts)
- ë¨¸ì²œíŠ¸/ì¹´í…Œê³ ë¦¬ slugëŠ” ì˜ë¬¸ (merchants: innisfree, categories: beauty)

### ë¯¸ë“¤ì›¨ì–´ ë³´í˜¸ ê²½ë¡œ
- `/brand/*` â€” ë¡œê·¸ì¸ í•„ìˆ˜ (â†’ /auth ë¦¬ë‹¤ì´ë ‰íŠ¸)
- `/submit`, `/me` â€” ë¹„ë¡œê·¸ì¸ ì ‘ê·¼ í—ˆìš© (í˜ì´ì§€ ë‚´ì—ì„œ ìœ ë„)

---

## API êµ¬ì¡° ìš”ì•½

### Public (ë¹„ë¡œê·¸ì¸)
- `GET /deals` â€” ë”œ ëª©ë¡/ê²€ìƒ‰ (q, category, merchant, benefit_tag, channel, date, sort)
- `GET /deals/:id` â€” ë”œ ìƒì„¸
- `GET /categories` â€” ì¹´í…Œê³ ë¦¬ íŠ¸ë¦¬
- `GET /merchants` / `GET /merchants/:id`
- `GET /home` â€” í™ˆ ì„¹ì…˜ (sponsored, trending, new, ending_soon, categories)
- `POST /api/submit` â€” ìœ ì € ì œë³´ âœ…

### Member (ë¡œê·¸ì¸)
- `POST /auth/phone/request` / `POST /auth/phone/verify` / `POST /auth/logout`
- `GET|PUT /me` â€” ë‚´ ì •ë³´
- ì €ì¥: `POST|DELETE|GET /me/saved-deals`
- êµ¬ë…: `POST|DELETE|GET /me/follows/merchants|categories`
- ì•Œë¦¼: `PUT /me/notification-preferences` (kakao/sms/email/push, ë¹ˆë„, quiet hours)
- ë™ì˜: `PUT /me/consents`
- ì•¡ì…˜: `POST /deals/:id/actions` (view, click_out, copy_code, save, share)
- í”¼ë“œë°±: `POST /deals/:id/feedback` (work/fail)
- ì œë³´: `POST /submissions` / `GET /submissions/my`

### Brand Portal
- `POST /brand/auth/login`
- `GET|PUT /brand/profile`
- `GET|POST|PUT /brand/deals` + `POST /brand/deals/:id/submit`
- `GET /brand/stats`

### Admin
- `GET|PATCH /admin/deals` (approve/reject/hide/merge)
- `GET|POST|PUT /admin/connectors` + test
- `GET|POST /admin/ai-crawl` â€” AI í¬ë¡¤ í˜„í™©/ì‹¤í–‰ âœ…
- `POST /admin/ai-crawl/:connectorId` â€” ë‹¨ì¼ AI í¬ë¡¤ âœ…
- `GET|POST|PUT /admin/ads/*`
- `GET /admin/affiliate/*` (runs, offers, sync, health)

### Cron
- `GET /api/cron/crawl` â€” ì¼ì¼ ìë™ í¬ë¡¤ ë°°ì¹˜ âœ…

### íŠ¸ë˜í‚¹
- `GET /out/:dealId` â€” ì•„ì›ƒë°”ìš´ë“œ ë¦¬ë‹¤ì´ë ‰íŠ¸ (í´ë¦­ë¡œê·¸ + 302) âœ…

---

## ë”œ íƒ€ì… ë¶„ë¥˜
| íƒ€ì… | ì„¤ëª… | CTA |
|------|------|-----|
| A1 | ì¿ í°/í”„ë¡œëª¨ì…˜ ì½”ë“œí˜• | CopyCodeButton + GoToSource |
| A2 | ê°€ê²©ë”œ/í•«ë”œ (ìµœì €ê°€/íŠ¹ê°€) | GoToSource (ì œíœ´ë§í¬) |
| B | ì•±ì¿ í°/ë§í¬í˜• | GetCouponButton + GoToSource |
| C | ì˜¤í”„ë¼ì¸ ì´ë²¤íŠ¸ | StoreInfoPanel + GoToSource |

---

## íƒœê·¸ ì²´ê³„
- **í˜œíƒ (benefit_tags)**: percent_off, amount_off, bogo, free_shipping, gift_with_purchase, bundle_deal, clearance, member_only, new_user, app_only, limited_time
- **ì¡°ê±´**: êµ¬ì¡°í™” conditions[] = { type, value, text }
- **ê¸´ê¸‰**: ending_soon_24h, ending_soon_3d, new_today, updated_today
- **ì±„ë„**: online_only, offline_only, hybrid

---

## ì¹´í…Œê³ ë¦¬ (12 ëŒ€ì¹´í…Œê³ ë¦¬)
| name | slug |
|------|------|
| íŒ¨ì…˜ | fashion |
| ë·°í‹° | beauty |
| ì‹í’ˆ/ë°°ë‹¬ | food |
| ìƒí™œ/ë¦¬ë¹™ | living |
| ë””ì§€í„¸/ê°€ì „ | digital |
| ì—¬í–‰/ë ˆì € | travel |
| ë¬¸í™”/ì½˜í…ì¸  | culture |
| í‚¤ì¦ˆ/êµìœ¡ | kids |
| ê±´ê°•/í—¬ìŠ¤ | health |
| ë°˜ë ¤ë™ë¬¼ | pets |
| ìë™ì°¨/ì£¼ìœ  | auto |
| ê¸ˆìœµ/í†µì‹  | finance |

---

## DB í…Œì´ë¸” (ì£¼ìš”)
| í…Œì´ë¸” | ìƒíƒœ | ë°ì´í„° |
|--------|------|--------|
| deals | âœ… | ~644 active (ì¤‘ë³µ ì •ë¦¬ ì§„í–‰) |
| merchants | âœ… | 283ê°œ |
| categories | âœ… | 12 ëŒ€ì¹´í…Œê³ ë¦¬ |
| crawl_connectors | âœ… | **228 active** / 96 disabled / 25 error |
| deal_actions | âœ… ì½”ë“œì™„ë£Œ | SQL ì‹¤í–‰ í•„ìš” |
| submissions | âœ… | 0 |

### deals í…Œì´ë¸” (ì „ì²´ ìŠ¤í‚¤ë§ˆ)
| ì»¬ëŸ¼ | íƒ€ì… | ë¹„ê³  |
|------|------|------|
| id | uuid | PK |
| merchant_id | uuid | FK â†’ merchants |
| category_id | uuid | FK â†’ categories |
| subcategory_id | uuid | nullable, FK â†’ categories |
| title | varchar | |
| description | text | nullable |
| deal_type | varchar | A1/A2/B/C |
| status | varchar | pending/active/hidden/expired |
| channel | varchar | online/offline/hybrid |
| benefit_tags | text[] | percent_off, amount_off ë“± 11ì¢… |
| benefit_summary | varchar | "ìµœëŒ€ 50% í• ì¸" |
| coupon_code | varchar | A1 íƒ€ì…ìš© |
| discount_value | numeric | % ë˜ëŠ” ì› |
| discount_type | varchar | percent/amount |
| price | numeric | A2 ê°€ê²©ë”œìš© |
| original_price | numeric | |
| discount_rate | numeric | |
| conditions | jsonb | [{type, value, text}] |
| how_to_use | text | |
| starts_at | timestamptz | |
| ends_at | timestamptz | |
| is_evergreen | boolean | ìƒì‹œ ì§„í–‰ ì—¬ë¶€ |
| source_type | varchar | crawl/brand/user_submit/affiliate/admin |
| source_url | text | ì›ë³¸ ë§í¬ |
| landing_url | text | ì´ë™ ë§í¬ |
| affiliate_url | text | ì œíœ´ ë§í¬ |
| affiliate_disclosure | boolean | |
| thumbnail_url | text | |
| og_image_url | text | |
| quality_score | integer | 0~100 |
| trending_score | integer | |
| view_count | integer | |
| click_out_count | integer | |
| save_count | integer | |
| feedback_work_count | integer | |
| feedback_fail_count | integer | |
| slug | varchar | SEO URL (í•œê¸€ í¬í•¨) |
| meta_title | varchar | |
| meta_description | varchar | |
| created_at | timestamptz | |
| updated_at | timestamptz | |
| expired_at | timestamptz | ì‹¤ì œ ë§Œë£Œ ì²˜ë¦¬ ì‹œê° |

### merchants í…Œì´ë¸” (283ê°œ)
| ì»¬ëŸ¼ | íƒ€ì… | ë¹„ê³  |
|------|------|------|
| id | uuid | PK |
| name | varchar | |
| slug | varchar | SEO URL (ì˜ë¬¸: oliveyoung, innisfree ë“±) |
| logo_url | text | Puppeteer/êµ¬ê¸€ ì´ë¯¸ì§€ ìˆ˜ì§‘ |
| brand_color | varchar | ë¸Œëœë“œ ê³ ìœ  ìƒ‰ìƒ (#hex), 264ê°œ ì ìš© |
| description | text | |
| official_url | text | 283ê°œ ì „ë¶€ ìˆìŒ |
| category_ids | uuid[] | |
| is_verified | boolean | |
| follower_count | integer | |
| active_deal_count | integer | |
| created_at | timestamptz | |
| updated_at | timestamptz | |

### categories í…Œì´ë¸” (12 ëŒ€ì¹´í…Œê³ ë¦¬)
| ì»¬ëŸ¼ | íƒ€ì… | ë¹„ê³  |
|------|------|------|
| id | uuid | PK |
| parent_id | uuid | nullable, ì…€í”„ì¡°ì¸ |
| name | varchar | í•œê¸€ (íŒ¨ì…˜, ë·°í‹° ë“±) |
| slug | varchar | ì˜ë¬¸ (fashion, beauty ë“±) |
| description | text | |
| icon | varchar | |
| sort_order | integer | |
| is_active | boolean | |
| deal_count | integer | |
| depth | integer | 0=ëŒ€, 1=ì¤‘, 2=ì†Œ |
| created_at | timestamptz | |

### crawl_connectors í…Œì´ë¸” (v3 ì»¬ëŸ¼ ì¶”ê°€)
```
id, name, merchant_id, source_url, config, status, fail_count,
last_run_at, created_at, updated_at,
content_hash VARCHAR(32),       -- âœ… v3 ì¶”ê°€: MD5 í•´ì‹œ
hash_updated_at TIMESTAMPTZ     -- âœ… v3 ì¶”ê°€: í•´ì‹œ ì €ì¥ ì‹œì 
```

### deal_actions í…Œì´ë¸”
id, deal_id, user_id(nullable), session_id(ppn_sid), action_type(view/click_out/copy_code/save/share), metadata(jsonb), created_at

### ì¡°ì¸ ê´€ê³„
```
deals.merchant_id â†’ merchants.id
deals.category_id â†’ categories.id (FK: deals_category_id_fkey)
deals.subcategory_id â†’ categories.id (FK: deals_subcategory_id_fkey)
categories.parent_id â†’ categories.id (ì…€í”„ì¡°ì¸)
```
**âš ï¸ Supabase ì¡°ì¸ ì‹œ ì£¼ì˜**: deals â†’ categories ì¡°ì¸ ì‹œ FK ëª…ì‹œ í•„ìš”
```
categories!deals_category_id_fkey (name)
```

### RLS ì •ì±…
| í…Œì´ë¸” | ì •ì±… | ì¡°ê±´ |
|--------|------|------|
| deals | Active deals are viewable by everyone | SELECT: status = 'active' OR 'expired' |
| deals | Admins can do everything | ALL: users.role IN ('admin', 'super_admin') |
| merchants | Merchants are viewable by everyone | SELECT: ì „ì²´ |
| categories | Categories are viewable by everyone | SELECT: ì „ì²´ |
| submissions | Anyone can insert | INSERT: true |
| submissions | Users can view own | SELECT: auth.uid() = user_id |

---

## AI í¬ë¡¤ëŸ¬ v3

### ì „ëµ ì „í™˜ íˆìŠ¤í† ë¦¬
1. **static_html íŒŒì‹±** â†’ ì‹¤íŒ¨ (í•œêµ­ ì‚¬ì´íŠ¸ ëŒ€ë¶€ë¶„ JS ë Œë”ë§ + AJAX)
2. **API ì§ì ‘ í˜¸ì¶œ** â†’ ì„±ê³µ (ìŠ¤íƒ€ë²…ìŠ¤ 36ê°œ, í´ë¦¬ì˜¤ 14ê°œ) ë‹¨, 162ê°œ ì‚¬ì´íŠ¸ë³„ API ì°¾ëŠ” ê±´ ë¹„í˜„ì‹¤ì 
3. **Puppeteer + Claude AI** â†’ âœ… ìµœì¢… ì±„íƒ. URLë§Œ ë“±ë¡í•˜ë©´ ìë™ ì¶”ì¶œ

### ì•„í‚¤í…ì²˜
```
ë¸Œëœë“œ URL (228ê°œ active)
  â†’ Puppeteer (ì´ë¯¸ì§€ ì°¨ë‹¨, 15s íƒ€ì„ì•„ì›ƒ)
    â†’ MD5 í•´ì‹œ vs DB content_hash ë¹„êµ
      â†’ ë³€ê²½ ì—†ìŒ â†’ ìŠ¤í‚µ (AI í˜¸ì¶œ ì•ˆ í•¨)
      â†’ ë³€ê²½ ìˆìŒ â†’ Claude Haiku íŒŒì‹± + í›„ì²˜ë¦¬ í•„í„°
        â†’ save-deals v2 (URL+title ì¤‘ë³µì²´í¬)
        â†’ content_hash DBì— ì €ì¥
```

### v1 â†’ v2 â†’ v3 ë³€ê²½ ì´ë ¥
| í•­ëª© | v1 | v2 | v3 |
|------|----|----|-----|
| íƒ€ì„ì•„ì›ƒ | 30ì´ˆ | 15ì´ˆ | 15ì´ˆ |
| ë¦¬ì†ŒìŠ¤ ì°¨ë‹¨ | í°íŠ¸/ë¯¸ë””ì–´/CSS | + ì´ë¯¸ì§€ | + ì´ë¯¸ì§€ |
| ë°°ì¹˜ | ìˆœì°¨ 1ê°œ | ë³‘ë ¬ 3ê°œ | ë³‘ë ¬ 3ê°œ |
| ë³€ê²½ê°ì§€ | ì—†ìŒ | ë©”ëª¨ë¦¬ í•´ì‹œ (ì¬ì‹œì‘ ì‹œ ì´ˆê¸°í™”) | **DB í•´ì‹œ (ì˜êµ¬ ìœ ì§€)** |
| ì¤‘ë³µ ì²´í¬ | URLë§Œ | URL + title | URL + title |
| 2íšŒì°¨ ì†Œìš” | 40~50ë¶„ | ì¬ì‹œì‘í•˜ë©´ ë˜ í’€í¬ë¡¤ | **~5ë¶„ (ì„œë²„ ì¬ì‹œì‘í•´ë„)** |
| 2íšŒì°¨ ë¹„ìš© | $4.32 | ì¬ì‹œì‘í•˜ë©´ ë˜ $4.32 | **~$0.50** |

### ì „ì²´ í¬ë¡¤ë§ ì‹¤ì 
| í•­ëª© | ìˆ˜ì¹˜ |
|------|------|
| ëŒ€ìƒ | 349ê°œ ì»¤ë„¥í„° (ì „ì²´) |
| ì„±ê³µ | 272/349 (78%) |
| ì‹ ê·œ ë”œ | **773ê°œ** |
| ì—…ë°ì´íŠ¸ ë”œ | **807ê°œ** |
| ë¹„ìš© | **$4.32** |

### ì»¤ë„¥í„° ì •ë¦¬ ê²°ê³¼
| ìƒíƒœ | ìˆ˜ëŸ‰ | ì„¤ëª… |
|------|------|------|
| **active** | **228ê°œ** | ì‹¤ì œ í¬ë¡¤ ëŒ€ìƒ |
| disabled | 96ê°œ | URL ì¤‘ë³µ 27 + ë¸Œëœë“œ ì¤‘ë³µ 69 |
| error | 25ê°œ | ì‹¤íŒ¨ 5íšŒ ì´ìƒ |
| **í•©ê³„** | **349ê°œ** | |

ì •ë¦¬ ë‚´ì—­: ì˜¬ë¦¬ë¸Œì˜ 10ê°œâ†’1ê°œ, LGì „ì 4ê°œâ†’1ê°œ, YES24/ì˜¤ëŠ˜ì˜ì§‘/Gë§ˆì¼“/ì¿ íŒ¡/ë¬´ì‹ ì‚¬/CGV ë“± 55ê°œ ë¸Œëœë“œ ì¤‘ë³µ ì œê±°

### ì˜ˆìƒ ì„±ëŠ¥
| í•­ëª© | ì²« ì‹¤í–‰ | 2íšŒì°¨~ |
|------|---------|--------|
| ëŒ€ìƒ | 228ê°œ | 228ê°œ (ë³€ê²½ë¶„ë§Œ AI) |
| ì†Œìš”ì‹œê°„ | ~25ë¶„ | **~5ë¶„** |
| API ë¹„ìš© | ~$3 | **~$0.50** |
| ë°°ì¹˜ ìˆ˜ | 76 (Ã·3) | ~76 (ëŒ€ë¶€ë¶„ ìŠ¤í‚µ) |

### ë¹„ìš© ì˜ˆì¸¡ (187ê°œ ë¸Œëœë“œ ê¸°ì¤€)
| ë°©ì‹ | ì›” ë¹„ìš© |
|------|--------|
| ë§¤ë²ˆ ì „ë¶€ AI í˜¸ì¶œ | ~$35 (5ë§Œì›) |
| ë³€ê²½ ê°ì§€ ì ìš© (20% ë³€ê²½) | ~$7 (1ë§Œì›) |

### í™˜ê²½ë³€ìˆ˜ (.env.local)
```
ANTHROPIC_API_KEY=sk-ant-api03-... (poppon ì „ìš© í‚¤, console.anthropic.comì—ì„œ ë°œê¸‰)
CRON_SECRET=... (Vercel Cron ì¸ì¦ìš©, ì„ íƒ)
```

### Anthropic API í‚¤ ê´€ë¦¬
- `poppon` í‚¤: POPPON í¬ë¡¤ëŸ¬ ì „ìš© (Haiku ëª¨ë¸)
- `harold-onboardi...` í‚¤: í•œì¤„ë¡œAI ì „ìš© (Sonnet ëª¨ë¸)
- ê°™ì€ ê³„ì •, í‚¤ ë¶„ë¦¬ë¡œ ë¹„ìš© ì¶”ì  ê°€ëŠ¥

---

## ë¨¸ì²œíŠ¸ ë¡œê³  ìˆ˜ì§‘ íˆìŠ¤í† ë¦¬

### ì „ëµ ë³€ì²œ
| ë²„ì „ | ë°©ì‹ | ê²°ê³¼ |
|------|------|------|
| v2 | HTTPë¡œ apple-touch-icon ê²½ë¡œ ì¶”ì¸¡ | 108 ê³ í’ˆì§ˆ + 168 ì €í’ˆì§ˆ(Google Favicon) + 7 ì‹¤íŒ¨ |
| v3.1 | Puppeteer ì‚¬ì´íŠ¸ ì ‘ì† + DOM íŒŒì‹± | 59ê°œ êµì²´ (SVG 13 + apple-touch 37 + header-logo 9) |
| êµ¬ê¸€ ì´ë¯¸ì§€ ê²€ìƒ‰ | Puppeteer `"[ë¸Œëœë“œëª…] CI"` ê²€ìƒ‰ | í…ŒìŠ¤íŠ¸ 10/10 ì„±ê³µ, ì „ì²´ ~102ê°œ ì‹¤í–‰ |

### í˜„ì¬ ë¡œê³  í’ˆì§ˆ ë¶„í¬ (ì¶”ì •)
| í’ˆì§ˆ | ìˆ˜ëŸ‰ | ì„¤ëª… |
|------|------|------|
| excellent (SVG) | ~15ê°œ | ë²¡í„°, ë¬´í•œ í™•ëŒ€ ê°€ëŠ¥ |
| good (apple-touch/manifest/êµ¬ê¸€) | ~150ê°œ | 128px+ ë˜ìŠ¤í„° |
| **ìˆ˜ë™ êµì²´ (public/logos/)** | **9ê°œ** | ì‚¼ì„±, ì˜¬ë¦¬ë¸Œì˜, êµë³´ë¬¸ê³ , ë¡¯ë°ì‹œë„¤ë§ˆ, ë°°ìŠ¤í‚¨ë¼ë¹ˆìŠ¤, ì´ë‹ˆìŠ¤í”„ë¦¬, ë‹Œí…ë„, ë”ë¸”í•˜íŠ¸, ìœ íŒ¡ |
| acceptable (header-logo) | ~20ê°œ | ì‚¬ì´íŠ¸ì—ì„œ ì¶”ì¶œí•œ ë¡œê³  img |
| ë¯¸ìˆ˜ì§‘/ì €í’ˆì§ˆ | ~90ê°œ | êµ¬ê¸€ ê²€ìƒ‰ìœ¼ë¡œ ë³´ì™„ |

### ìˆ˜ë™ êµì²´ ë¡œê³  (public/logos/)
| íŒŒì¼ëª… | ë¨¸ì²œíŠ¸ |
|--------|--------|
| samsung.svg | ì‚¼ì„±ë‹·ì»´ |
| oliveyoung.png | ì˜¬ë¦¬ë¸Œì˜ |
| kyobobook.png | êµë³´ë¬¸ê³  |
| lottecinema.jpg | ë¡¯ë°ì‹œë„¤ë§ˆ |
| baskinrobbins.png | ë°°ìŠ¤í‚¨ë¼ë¹ˆìŠ¤ |
| innisfree.png | ì´ë‹ˆìŠ¤í”„ë¦¬ |
| nintendo.jpg | ë‹Œí…ë„ |
| doubleheart.png | ë”ë¸”í•˜íŠ¸ |
| upang.jpg | ìœ íŒ¡ |

---

## ë¸Œëœë“œ ë¦¬ìŠ¤íŠ¸ í˜„í™©
| í•­ëª© | ìˆ˜ëŸ‰ | ë¹„ê³  |
|------|------|------|
| Gemini ì¡°ì‚¬ ì›ë³¸ | 601ê°œ | 12ê°œ ì¹´í…Œê³ ë¦¬ |
| 1ì°¨ í•„í„°ë§ (ëª…í’ˆ/K-pop ë“± ì œê±°) | 494ê°œ | 107ê°œ ì œì™¸ |
| ì´ë²¤íŠ¸ URL ìë™ íƒì§€ | 223ê°œ | detect-event-pages.ts |
| 2ì°¨ í•„í„°ë§ (ê²Œì„ì‚¬/í•˜ë“œì›¨ì–´/ì¤‘ë³µ ë“±) | -50ê°œ | ì“¸ëª¨ì—†ëŠ” ë¸Œëœë“œ ì œê±° |
| ëŒ€í˜• ìˆ˜ë™ ì¶”ê°€ | +14ê°œ | ì˜¬ë¦¬ë¸Œì˜, CU, GS25, ì¿ íŒ¡, ìœ ë‹ˆí´ë¡œ ë“± |
| **ìµœì¢… í¬ë¡¤ë§ ëŒ€ìƒ** | **187ê°œ** | 1ì°¨ 90 + 2ì°¨ 97 |
| DB ì‹œë“œ ì™„ë£Œ (merchants) | 283ê°œ | ê¸°ì¡´ 145 + ì‹ ê·œ ë³‘í•© |
| DB ì‹œë“œ ì™„ë£Œ (connectors) | 349ê°œ | ê¸°ì¡´ 162 + ì‹ ê·œ 187 |

### ì œì™¸ëœ ë¸Œëœë“œ
- ëª…í’ˆ 49ê°œ (êµ¬ì°Œ, ìƒ¤ë„¬, ë£¨ì´ë¹„í†µ ë“± â€” ì˜¨ë¼ì¸ ì¿ í° ì—†ìŒ)
- K-pop 20ê°œ (BTS, ë‰´ì§„ìŠ¤ ë“± â€” ë”œ ë¬´ê´€)
- ì œì•½ì‚¬/ì•½ ë¸Œëœë“œ 27ê°œ (ì…€íŠ¸ë¦¬ì˜¨, íŒì½œ ë“± â€” ì†Œë¹„ì ì´ë²¤íŠ¸ ì—†ìŒ)
- í•´ì™¸ ì „ìš© ì„œë¹„ìŠ¤ 11ê°œ (ë””ì¦ˆë‹ˆ+, ìŠ¤í¬í‹°íŒŒì´ ë“±)
- ê²Œì„ì‚¬ (ì—”ì”¨ì†Œí”„íŠ¸, ë„¥ìŠ¨, í¬ë˜í”„í†¤ â€” ì¸ê²Œì„ ì´ë²¤íŠ¸)
- í•˜ë“œì›¨ì–´ (ê³ í”„ë¡œ, ë ˆë…¸ë²„, ì—ì´ìˆ˜ìŠ¤ â€” ì†Œë¹„ì ì¿ í° ì—†ìŒ)
- ì¤‘ë³µ URL (ê°™ì€ ëª¨íšŒì‚¬ ì´ë²¤íŠ¸ í˜ì´ì§€ ê³µìœ )

---

## ğŸ‘¤ íšŒì›ê°€ì… & í–‰ë™ì¶”ì  (ì„¤ê³„ ì™„ë£Œ)

### ê°€ì… íŠ¸ë¦¬ê±°
ë”œ ì €ì¥, ë¸Œëœë“œ êµ¬ë…, ì¿ í° 3íšŒ~, í”¼ë“œë°± â†’ ê°€ì… ë°”í…€ì‹œíŠ¸

### í”Œë¡œìš°
PASS ë³¸ì¸ì¸ì¦ â†’ ê´€ì‹¬ ì¹´í…Œê³ ë¦¬(3ê°œ+) â†’ ë§ˆì¼€íŒ… ë™ì˜ â†’ ì™„ë£Œ

### êµ¬í˜„ í˜„í™©
- âœ… deal_actions + tracking.ts + API (session_id ê¸°ë°˜)
- âœ… DealDetail/CopyCodeButton/out ì—°ë™
- â¬œ PASS ë³¸ì¸ì¸ì¦, ê°€ì… UI, ë”œ ì €ì¥, êµ¬ë…, ì•Œë¦¼í†¡

### deal_actions SQL (Supabase ì‹¤í–‰ í•„ìš”)
```sql
CREATE TABLE IF NOT EXISTS deal_actions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  deal_id UUID NOT NULL REFERENCES deals(id) ON DELETE CASCADE,
  user_id UUID REFERENCES auth.users(id) ON DELETE SET NULL,
  session_id VARCHAR(64),
  action_type VARCHAR(30) NOT NULL,
  metadata JSONB,
  created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
);
CREATE INDEX idx_deal_actions_deal_id ON deal_actions(deal_id);
CREATE INDEX idx_deal_actions_session_deal ON deal_actions(session_id, deal_id, action_type);
CREATE INDEX idx_deal_actions_user_id ON deal_actions(user_id) WHERE user_id IS NOT NULL;
CREATE INDEX idx_deal_actions_created ON deal_actions(created_at);
CREATE INDEX idx_deal_actions_type ON deal_actions(action_type);
ALTER TABLE deal_actions ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Anyone can insert actions" ON deal_actions FOR INSERT WITH CHECK (true);
CREATE POLICY "Service role can read actions" ON deal_actions FOR SELECT USING (auth.role() = 'service_role');
CREATE OR REPLACE FUNCTION increment_view_count(deal_id_input UUID) RETURNS void AS $$ BEGIN UPDATE deals SET view_count = COALESCE(view_count, 0) + 1 WHERE id = deal_id_input; END; $$ LANGUAGE plpgsql SECURITY DEFINER;
CREATE OR REPLACE FUNCTION increment_click_out_count(deal_id_input UUID) RETURNS void AS $$ BEGIN UPDATE deals SET click_out_count = COALESCE(click_out_count, 0) + 1 WHERE id = deal_id_input; END; $$ LANGUAGE plpgsql SECURITY DEFINER;
```

---

## TargetUP-AI ì—°ë™ (ìˆ˜ìµí™”)
- **ìµœì†Œ ì„¸ê·¸ë¨¼íŠ¸ ë°ì´í„°**: phone_hash, marketing_opt_in, ê´€ì‹¬ ì¹´í…Œê³ ë¦¬/ë¸Œëœë“œ, ìµœê·¼ 30/60/90ì¼ í–‰ë™ ìš”ì•½
- **ì—°ë™ ë°©ì‹**: v1ì—ì„œëŠ” ì˜µì…˜ B(ì¼ ë°°ì¹˜) ê¶Œì¥ â€” segments_daily í…Œì´ë¸” ë™ê¸°í™”
- **ì˜ˆì‹œ ì„¸ê·¸ë¨¼íŠ¸**: beauty_skin_30d_active, food_delivery_high_intent ë“±

---

## ìš´ì˜ ì •ì±… í•µì‹¬
- ì¶œì²˜/ê³µì‹ë§í¬ í•­ìƒ í‘œì‹œ, ì´ë¯¸ì§€ëŠ” ì¸ë„¤ì¼/OG ìˆ˜ì¤€
- í¬ë¡¤ë§: robots ì¡´ì¤‘, ì‹¤íŒ¨ 3íšŒ â†’ ìë™ ë¹„í™œì„±í™”
- ë§Œë£Œ: ìë™ expired ì „í™˜, SEO 7~30ì¼ ìœ ì§€ í›„ noindex
- í’ˆì§ˆ: ì•ˆë¨ 10ê±´+/30%â†‘ â†’ ê²€ìˆ˜, 30ê±´+/50%â†‘ â†’ ìˆ¨ê¹€
- ê´‘ê³ : ìŠ¤í°ì„œ ë¼ë²¨ í•„ìˆ˜, í’ˆì§ˆ ê·œì¹™ ë™ì¼ ì ìš©
- ê°œì¸ì •ë³´: ë§ˆì¼€íŒ… ë™ì˜ ê¸°ë¡, ì² íšŒ ì¦‰ì‹œ ë°˜ì˜+ì´ë ¥ ë³´ê´€

---

## ë¶„ì„ ì´ë²¤íŠ¸ (í•„ìˆ˜ ìˆ˜ì§‘)
deal_view, deal_click_out, deal_copy_code, deal_save, merchant_follow, category_follow, deal_feedback_work/fail, search_performed, signup_start/complete, marketing_opt_in_on/off, digest_sent

---

## ê°œë°œ Phase & ì§„í–‰ ìƒí™©

### Phase 0 â€” âœ… ì™„ë£Œ
| í•­ëª© | ë¹„ê³  |
|------|------|
| **DB/ìŠ¤í‚¤ë§ˆ** | 18ê°œ í…Œì´ë¸” + RLS + í•¨ìˆ˜ + íŠ¸ë¦¬ê±° |
| ì¹´í…Œê³ ë¦¬ íƒì†Œë…¸ë¯¸ | 12ëŒ€ ì¹´í…Œê³ ë¦¬ ì‹œë“œ ì™„ë£Œ |
| íƒœê·¸ ì‚¬ì „ | 11ì¢… benefit_tags ì •ì˜ |
| ë¸Œëœë“œ(Merchant) í…Œì´ë¸” | 283ê°œ ì‹œë“œ + brand_color 264ê°œ ì ìš© |
| ì œíœ´ ë„¤íŠ¸ì›Œí¬ í…Œì´ë¸” | affiliate_networks, affiliate_offers, affiliate_merchant_map |
| **ì‚¬ìš©ì ì›¹ (SEO ìš°ì„ )** | |
| / í™ˆ | íŠ¸ë Œë”©/ì‹ ê·œ/ë§ˆê°ì„ë°• 3ê°œ ì„¹ì…˜, ë¸Œëœë“œë‹¹ 2ê°œ ì¤‘ë³µì œê±° |
| /search ê²€ìƒ‰ ê²°ê³¼ | í’€í…ìŠ¤íŠ¸ ê²€ìƒ‰(ilike) + ì¹´í…Œê³ ë¦¬/í˜œíƒ/ì±„ë„ í•„í„° + ì •ë ¬ 4ì¢… + í˜ì´ì§€ë„¤ì´ì…˜ |
| /c/:categorySlug ì¹´í…Œê³ ë¦¬ í—ˆë¸Œ | ì¹´í…Œê³ ë¦¬ë³„ ê·¸ë¼ë””ì–¸íŠ¸ í—¤ë” + ì„œë¸Œì¹´í…Œê³ ë¦¬ ì¹© + ì •ë ¬ + í˜ì´ì§€ë„¤ì´ì…˜ |
| /d/:slug ë”œ ìƒì„¸ | **í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë‹¬** â€” ë¦¬ìŠ¤íŠ¸ í´ë¦­=ëª¨ë‹¬, ì§ì ‘ì ‘ì†=í’€í˜ì´ì§€(SEO) |
| /m/:merchantSlug ë¸Œëœë“œê´€ | í”„ë¡œí•„ + êµ¬ë…ë²„íŠ¼ + ì§„í–‰ì¤‘/ì¢…ë£Œ íƒ­ + ì •ë ¬ + í˜ì´ì§€ë„¤ì´ì…˜ |
| /submit ì œë³´í•˜ê¸° | URL+ì½”ë©˜íŠ¸ í¼, ì¤‘ë³µì²´í¬, ë¹„ë¡œê·¸ì¸ ê°€ëŠ¥ |
| /auth ë¡œê·¸ì¸/ê°€ì… | íœ´ëŒ€í° ì¸ì¦ UI (Supabase OTP ë¯¸ì—°ê²°) |
| /me ë§ˆì´í˜ì´ì§€ | ë¹„ë¡œê·¸ì¸â†’ë¡œê·¸ì¸ìœ ë„ UI, ì €ì¥ë”œ/êµ¬ë…/ì„¤ì • 3íƒ­ (UI shell) |
| **ì–´ë“œë¯¼** | ëŒ€ì‹œë³´ë“œ + ë”œ CRUD + ë¨¸ì²œíŠ¸ CRUD + í¬ë¡¤ ê´€ë¦¬ |
| **AI í¬ë¡¤ëŸ¬** | Puppeteer + Claude Haiku, ë³€ê²½ ê°ì§€, ì´ë²¤íŠ¸ í˜ì´ì§€ ìë™ íƒì§€ |
| **ì „ì²´ í¬ë¡¤ë§** | 272/349 ì„±ê³µ, ì‹ ê·œ 773 + ì—…ë°ì´íŠ¸ 807, $4.32 |
| **ë¨¸ì²œíŠ¸ ë¡œê³ ** | v2 + v3.1 + êµ¬ê¸€ ì´ë¯¸ì§€ ê²€ìƒ‰ + ìˆ˜ë™êµì²´ 9ì¢…, brand_color 264ê°œ |
| **ì¹´í…Œê³ ë¦¬ í˜ì´ì§€ ë¦¬ë””ìì¸** | ê·¸ë¼ë””ì–¸íŠ¸ í—¤ë” ì œê±° â†’ íƒ­ë°”(12ê°œ ê°€ë¡œìŠ¤í¬ë¡¤) + Lucide ì•„ì´ì½˜ + ì»´íŒ©íŠ¸ í—¤ë” |
| **ë§Œë£Œ ìë™í™”** | filterActiveDeals + Cron ì¼ê´„ ì „í™˜ |
| **ëª¨ë°”ì¼ ë°˜ì‘í˜•** | 12íŒŒì¼ ìˆ˜ì •, ëª¨ë°”ì¼ í¼ìŠ¤íŠ¸ |
| **í–‰ë™ì¶”ì ** | deal_actions + tracking.ts + API |
| **Vercel ë°°í¬** | Git push ìë™ ë°°í¬ ë¼ì´ë¸Œ |

### Phase 1 â€” ì§„í–‰ì¤‘
| í•­ëª© | ìƒíƒœ |
|------|------|
| í¬ë¡¤ëŸ¬ v3 (ë³‘ë ¬+DBí•´ì‹œ+ì¤‘ë³µë°©ì§€) | âœ… |
| ì»¤ë„¥í„° ì •ë¦¬ (349â†’228 active) | âœ… |
| deal_actions ë¡œê¹… | âœ… ì½”ë“œ (SQL í•„ìš”) |
| Vercel Cron | âœ… ì„¤ì • (DNS í›„ í™œì„±í™”) |
| PASS ë³¸ì¸ì¸ì¦ + ê°€ì… | â¬œ |
| ë”œ ì €ì¥ / ë¸Œëœë“œ êµ¬ë… | â¬œ |
| ì¹´ì¹´ì˜¤ ì•Œë¦¼í†¡ | â¬œ |

### Phase 2 â€” ë¯¸ì°©ìˆ˜
ë¸Œëœë“œ í¬í„¸ / ìŠ¤í°ì„œ ìŠ¬ë¡¯ / ì„±ê³¼ ì •ì‚°

---

## ğŸ”¥ ë‹¤ìŒ ì‘ì—… (ìš°ì„ ìˆœìœ„)

### ì¦‰ì‹œ
1. **"ë‹¤ìŒ ì±„íŒ… ì‹œì‘ ì‹œ ì¦‰ì‹œ í™•ì¸ì‚¬í•­" 1~5 SQL ì „ë¶€ ì‹¤í–‰**
2. **deal_actions SQL ì‹¤í–‰**
3. **ê°€ë¹„ì•„ DNS** â€” A: `@`â†’`216.198.79.1`, CNAME: `www`â†’`12a1927535fa4753.vercel-dns-017.com.`
4. **v3ë¡œ ì²« í’€í¬ë¡¤ ì‹¤í–‰** â†’ í•´ì‹œ DBì— ìŒ“ì„ â†’ 2íšŒì°¨ë¶€í„° 5ë¶„

### ë³´ê°•
5. filterActiveDeals ì¹´í…Œê³ ë¦¬/ë¸Œëœë“œê´€ ì ìš©
6. ë¡œê³  ì¶”ê°€ êµì²´ (ë‚˜ë¨¸ì§€ ì €í’ˆì§ˆ ~100ê°œ)

### íšŒì›
7. PASS ë³¸ì¸ì¸ì¦
8. ê°€ì… UI + ë”œ ì €ì¥ + êµ¬ë…
9. ë§ˆì´í˜ì´ì§€

---

## ë§Œë£Œ ìë™í™”
- filterActiveDeals: í™ˆ/ê²€ìƒ‰ âœ…, ì¹´í…Œê³ ë¦¬/ë¸Œëœë“œê´€ â¬œ
- Cron ì¼ê´„ ì „í™˜: ë§¤ì¼ 06:00 KST

---

## ë°°ì¹˜ ìŠ¤ì¼€ì¤„
- **í˜„ì¬**: Vercel Cron â€” ë§¤ì¼ 06:00 KST (21:00 UTC)
- **ì¶”í›„**: 06:00 / 12:00 / 18:00 / 23:00
- **ìˆœì„œ**: â‘  Affiliate Ingest â†’ â‘¡ Crawl Ingest â†’ â‘¢ Expire/Quality ì¬ê³„ì‚° â†’ â‘£ ë¦¬í¬íŠ¸ ìƒì„±

---

## ğŸ–¥ï¸ ì¸í”„ë¼ ì„¤ê³„ (í•©ì˜, ë¯¸ì°©ìˆ˜)
- **í˜„ì¬**: Vercel Pro ($20/ì›”) â€” ê°œë°œ ì¤‘ ì‚¬ìš©, NCP ì´ê´€ ì „ê¹Œì§€
- **ì´ê´€ ê³„íš**: NCP s2-g3 (4vCPU/16GB) ~8ë§Œ + Supabase Pro ~3.4ë§Œ + Haiku ~1.4ë§Œ = **ì›” ~13ë§Œì›**
- Docker êµ¬ì„± â†’ ìƒìš©ì„œë²„ ì´ê´€ ëŒ€ë¹„

---

## ğŸ“± ëª¨ë°”ì¼ ë°˜ì‘í˜• (âœ… ì™„ë£Œ)
12íŒŒì¼ ìˆ˜ì •, ëª¨ë°”ì¼ í¼ìŠ¤íŠ¸, 44px í„°ì¹˜ íƒ€ê²Ÿ, safe-area, ë°”í…€ì‹œíŠ¸ íŒ¨í„´

---

## DealCard v4.2
í°ìƒ‰ ë°°ê²½, brand_color ì•¡ì„¼íŠ¸, ë¡œê³  ë¹„ìœ¨ ë™ì , ì¿ í° ì ì„ , ë§ˆê°ì„ë°• 7ì¼ ì´ë‚´

---

## ì•Œë ¤ì§„ ì´ìŠˆ
- í•œê¸€ slug â†’ decodeURIComponent í•„ìˆ˜
- Supabase ì¡°ì¸ FK ëª…ì‹œ í•„ìˆ˜
- ì¤‘ë³µ merchant: ì‚¼ì„±ë‹·ì»´+ì‚¼ì„±ì „ìê°€ì „ ë³‘í•© ì™„ë£Œ / ì˜¬ë¦¬ë¸Œì˜ì€ 1ê°œë§Œ ë‚¨ìŒ / ë‚˜ë¨¸ì§€ ë¹ˆ ê»ë°ê¸°(LGìƒí™œê±´ê°•, ë¡¯ë°ì¹´ë“œ ë“±) ì¶”í›„ í¬ë¡¤ëŸ¬ ì¶”ê°€ìš©ìœ¼ë¡œ ìœ ì§€
- ëª¨ë‹¬ ë‚´ë¶€ ë§í¬ â†’ `<a>` hard navigation
- categories.deal_count DB ê°’ 0 â†’ active ë”œ ì‹¤ì œ ì§‘ê³„ë¡œ ëŒ€ì²´
- ë³‘ë ¬ í¬ë¡¤ concurrency ê¸°ë³¸ 3 (API bodyì—ì„œ ì¡°ì ˆ, ìµœëŒ€ 5)
- brand_color: 264/283ê°œ ì ìš©, ë°ê¸° ìë™ íŒë‹¨ (W3C íœ˜ë„) â†’ í°/ê²€ í…ìŠ¤íŠ¸ ìë™ ê²°ì •
- ë”œ ì´ë¯¸ì§€: thumbnail_urlì€ DealCardì—ì„œ ì‚¬ìš© ì•ˆ í•¨ (ë¡œê³  ì¤‘ì‹¬ ë””ìì¸)
- Puppeteer waitForTimeout: ì‹ ë²„ì „ì—ì„œ ì œê±°ë¨ â†’ `new Promise(r => setTimeout(r, ms))` ì‚¬ìš©
- Vercel ë¹Œë“œ: Supabase `.rpc()` ë°˜í™˜ PromiseLikeì— `.catch()` ë¶ˆê°€ â†’ `.then(() => {}, () => {})` ì‚¬ìš©
- Vercel ë¹Œë“œ: íƒ€ì… ì²´í¬ ë¡œì»¬ë³´ë‹¤ ì—„ê²© â€” SaveResult ë“± ì¸í„°í˜ì´ìŠ¤ í•„ìˆ˜ í•„ë“œ ëˆ„ë½ ì£¼ì˜
- ë¡œê³  ìˆ˜ë™êµì²´: `public/logos/` + DB logo_url ë™ì‹œ ì—…ë°ì´íŠ¸ í•„ìš”

---

## ì±„íŒ… íˆìŠ¤í† ë¦¬
| ì±„íŒ… | ë‚ ì§œ | ì£¼ìš” ë‚´ìš© |
|------|------|-----------|
| íŒí°-ì›¹ì‚¬ì´íŠ¸ê°œë°œì‹œì‘ | 2/14 | DB, ì–´ë“œë¯¼, í¬ë¡¤ëŸ¬ ê¸°ì´ˆ |
| íŒí°-í¬ë¡¤ë§ì—ëŒ€í•œê³ ë¯¼ | 2/14 | Puppeteer+AI ì „ëµ |
| íŒí°-í¬ë¡¤ë§ì™„ë£Œ | 2/14 | 1ì°¨ í¬ë¡¤ë§, 455ê°œ ë”œ |
| íŒí°-ìƒì„¸ ê°œë°œ í˜ì´ì§€ ë“± | 2/15 | í™ˆ, ë”œìƒì„¸, ë¡œê³  v2 |
| íŒí°-ë¸Œëœë“œê´€ ë“± ê¸°íƒ€ | 2/15 | ë¸Œëœë“œê´€/ê²€ìƒ‰/ì¹´í…Œê³ ë¦¬/Cron |
| íŒí°-ì¤‘ë³µì œê±° ë° ë¡œê³  | 2/15 | DealCard ë¦¬ë””ìì¸ |
| íŒí°-ìŠ¤í…Œì´í„°ìŠ¤ ì •ë¦¬ | 2/15 | STATUS.md ì •ë¦¬ |
| íŒí°-DealCard+ë¡œê³  | 2/15 | brand_color, DealCard v3 |
| íŒí°-DealCard v4+ë¡œê³ v4 | 2/16 | DealCard v4.2, ë¡œê³  v4 |
| íŒí°-STATUS+ë§Œë£Œ+ë²„ê·¸ | 2/16 | ë§Œë£Œ ìë™í™” |
| íŒí°-í´ë¦­íŠ¸ë˜í‚¹+ì–´ë“œë¯¼+ë°°í¬ | 2/16 | í´ë¦­íŠ¸ë˜í‚¹, ì–´ë“œë¯¼ ë³´í˜¸ |
| íŒí°-ëª¨ë°”ì¼ë°˜ì‘í˜•+í¬ë¡¤ëŸ¬+ë°°í¬ | 2/16 | ëª¨ë°”ì¼ 12íŒŒì¼, Vercel ë°°í¬ |
| **íŒí°-í¬ë¡¤ë§ìµœì í™”+íšŒì›ì„¤ê³„+í–‰ë™ì¶”ì ** | **2/16** | **í¬ë¡¤ëŸ¬ v3 (DBí•´ì‹œ), save-deals v2, ì»¤ë„¥í„° 349â†’228 ì •ë¦¬, ì¤‘ë³µë”œ ì •ë¦¬, deal_actions, íšŒì›ì„¤ê³„, NCP ì¸í”„ë¼, ì™¸ì£¼ë¦¬ë·°** |
| **íŒí°-STATUSë³µì›+ë¡œê³ +ì¹´í…Œê³ ë¦¬ë¦¬ë””ìì¸** | **2/16** | **STATUS.md ë³µì›(355â†’750ì¤„), ì‚¼ì„± ë¨¸ì²œíŠ¸ ë³‘í•©, ë¡œê³  9ì¢… ìˆ˜ë™êµì²´, ì¹´í…Œê³ ë¦¬ í˜ì´ì§€ ë¦¬ë””ìì¸(íƒ­ë°”+Lucide), Vercel ë¹Œë“œ ì—ëŸ¬ 3ê±´ ìˆ˜ì •, Vercel Pro ì „í™˜** |

---

*ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2026-02-16 (STATUS ë³µì› + ë¡œê³  9ì¢… + ì‚¼ì„± ë³‘í•© + ì¹´í…Œê³ ë¦¬ ë¦¬ë””ìì¸ + Vercel Pro)*
